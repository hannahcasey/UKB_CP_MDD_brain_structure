geom_label_repel(aes(label = ifelse(p.adjust < 0.05,as.character(brain_phenotype_plot),'')),
size = 2,
box.padding = 2,
segment.alpha = 0.5,
point.padding = 0,
segment.color = 'grey50',
position = position_jitter(seed = 151097),
max.overlaps = 100,
fill = "white",
show.legend = FALSE) +
theme_classic() +
ylim(c(0,(max(brain_structure_CP_female$p.adjust.minus.log) + 1))) +
theme(axis.text.x = element_blank()) +
xlab("") + ylab("-log10(p)") +
scale_color_manual(values = pal2) +
guides(fill=guide_legend(override.aes=list(shape=21)), colour=guide_legend(title = "Brain Strucutre Subcategory"))
plot_CP_males <- ggplot(brain_structure_CP_male, aes(x = brain_structure_type, y = p.adjust.minus.log, colour =  brain_structure_type, shape = Direction, stroke = 1, fill = `Adjusted p-value < 0.05`)) +
scale_shape_manual(values=c(25, 24)) +
scale_fill_manual(values = c("white", "dark grey")) +
geom_jitter(size = 2, position = position_jitter(seed = 151097)) +
geom_hline(yintercept=-log10(0.05), linetype="dashed",
color = "red", size=1, alpha = 0.4) +
geom_label_repel(aes(label = ifelse(p.adjust < 0.05,as.character(brain_phenotype_plot),'')),
box.padding = 2,
size = 2,
point.padding = 0,
segment.color = 'grey50',
segment.alpha = 0.5,
position = position_jitter(seed = 151097),
max.overlaps = 100,
fill = "white",
show.legend = FALSE)  +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, vjust = 1)) +
xlab("") + ylab("-log10(p)") +
scale_color_manual(values = pal2) +
scale_y_reverse(limits = c((max(brain_structure_CP_female$p.adjust.minus.log) + 1),0)) +
scale_x_discrete(position = "top") +
theme(plot.margin = unit(c(-1, 0, 0, 0), "cm"))
# arrange the three plots in a single row
prow <- cowplot::plot_grid(
plot_CP_females + theme(legend.position="none"),
plot_CP_males + theme(legend.position="none"),
ncol = 1,
rel_heights = c(1,1.2))
# extract the legend from one of the plots
legend <- cowplot::get_legend(plot_CP_females+ theme(legend.box.margin = margin(50, 100, 0, 50)))
# add the legend to the row we made earlier. Give it one-third of
# the width of one plot (via rel_widths).
cowplot::plot_grid(prow, legend, rel_widths = c(2, 1))
## Remove balanced dataset results
res_CP_MDD_brain_structure_no_balanced <- res_CP_MDD_brain_structure[!grepl("Balanced", res_CP_MDD_brain_structure$sample),]
## Get only regional cortical volumes in chronic pain
res_CP_MDD_brain_structure_regional_cortical_volumes <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Volumes") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_volumes$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_volumes[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "All")] <- "Chronic Pain: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "Female")] <- "Chronic Pain: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "Male")] <- "Chronic Pain: Male Sample"
regional_cortical_volumes_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_volumes$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_volumes$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_volumes$group
)
## Order groups
regional_cortical_volumes_ggseg$groups <- ordered(regional_cortical_volumes_ggseg$groups, levels = c("Chronic Pain: Full Sample", "Chronic Pain: Female Sample", "Chronic Pain: Male Sample"))
ggplot() +
geom_brain(atlas = dk,
hemi = "right") +
scale_fill_brain2(wes_palette("Darjeeling1",35,type = "continuous")) +
theme_minimal()
p1 <- regional_cortical_volumes_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
## Get only regional cortical areas in chronic pain
res_CP_MDD_brain_structure_regional_cortical_areas <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Areas") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_areas$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_areas[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "All")] <- "Chronic Pain: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "Female")] <- "Chronic Pain: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "Male")] <- "Chronic Pain: Male Sample"
regional_cortical_areas_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_areas$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_areas$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_areas$group
)
## Order groups
regional_cortical_areas_ggseg$groups <- ordered(regional_cortical_areas_ggseg$groups, levels = c("Chronic Pain: Full Sample", "Chronic Pain: Female Sample", "Chronic Pain: Male Sample"))
p2 <- regional_cortical_areas_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
## Get only regional cortical thickness in chronic pain
res_CP_MDD_brain_structure_regional_cortical_thickness <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Thickness") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_thickness$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_thickness[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "All")] <- "Chronic Pain: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "Female")] <- "Chronic Pain: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "Male")] <- "Chronic Pain: Male Sample"
regional_cortical_thickness_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_thickness$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_thickness$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_thickness$group
)
## Order groups
regional_cortical_thickness_ggseg$groups <- ordered(regional_cortical_thickness_ggseg$groups, levels = c("Chronic Pain: Full Sample", "Chronic Pain: Female Sample", "Chronic Pain: Male Sample"))
## Only display one hemisphere ase resutls are unilateral
p3 <- regional_cortical_thickness_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
## Get only regional sub cortical volume
res_CP_MDD_brain_structure_regional_subcortical_volume <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Subcortical Volumes") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain"),]
sub_cortical_regions <- c("thalamus proper","caudate", "putamen", "pallidum", "hippocampus", "amygdala", "accumbens area")
res_CP_MDD_brain_structure_regional_subcortical_volume$regions_ggseg <- sub_cortical_regions
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_subcortical_volume[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "All")] <- "Chronic Pain: Full Sample"
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "Female")] <- "Chronic Pain: Female Sample"
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "chronic_pain") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "Male")] <- "Chronic Pain: Male Sample"
regional_subcortical_volume_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_subcortical_volume$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_subcortical_volume$beta,
groups = res_CP_MDD_brain_structure_regional_subcortical_volume$group
)
## Order groups
regional_subcortical_volume_ggseg$groups <- ordered(regional_subcortical_volume_ggseg$groups, levels = c("Chronic Pain: Full Sample", "Chronic Pain: Female Sample", "Chronic Pain: Male Sample", "Depression: Full Sample", "Depression: Female Sample", "Depression: Male Sample"))
ggplot() +
geom_brain(atlas = aseg,
hemi = "right") +
scale_fill_brain2(wes_palette("Darjeeling1",8,type = "continuous")) +
theme_minimal()
p4 <- regional_subcortical_volume_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = aseg,
aes(fill = `Standardized β`),
hemi = "left") +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal() +
theme(panel.spacing = unit(22, "lines"))
(p1 / p2 / p3 / p4) + plot_annotation(tag_levels = 'A') & theme(strip.text.x = element_text(size = 20), legend.text = element_text(size = 10), legend.title = element_text(size = 15), plot.tag = element_text(size = 30))
## Remove balanced dataset results
res_CP_MDD_brain_structure_no_balanced <- res_CP_MDD_brain_structure[!grepl("Balanced", res_CP_MDD_brain_structure$sample),]
## Get only regional cortical volumes in chronic pain
res_CP_MDD_brain_structure_regional_cortical_volumes <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Volumes") & (res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_volumes$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_volumes[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "All")] <- "Depression: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "Female")] <- "Depression: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_volumes$group[(res_CP_MDD_brain_structure_regional_cortical_volumes$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_volumes$sample == "Male")] <- "Depression: Male Sample"
regional_cortical_volumes_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_volumes$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_volumes$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_volumes$group
)
## Order groups
regional_cortical_volumes_ggseg$groups <- ordered(regional_cortical_volumes_ggseg$groups, levels = c("Depression: Full Sample", "Depression: Female Sample", "Depression: Male Sample"))
ggplot() +
geom_brain(atlas = dk,
hemi = "right") +
scale_fill_brain2(wes_palette("Darjeeling1",35,type = "continuous")) +
theme_minimal()
p1 <- regional_cortical_volumes_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
## Get only regional cortical areas in chronic pain
res_CP_MDD_brain_structure_regional_cortical_areas <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Areas") & (res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_areas$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_areas[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "All")] <- "Depression: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "Female")] <- "Depression: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_areas$group[(res_CP_MDD_brain_structure_regional_cortical_areas$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_areas$sample == "Male")] <- "Depression: Male Sample"
regional_cortical_areas_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_areas$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_areas$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_areas$group
)
## Order groups
regional_cortical_areas_ggseg$groups <- ordered(regional_cortical_areas_ggseg$groups, levels = c("Depression: Full Sample", "Depression: Female Sample", "Depression: Male Sample"))
p2 <- regional_cortical_areas_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
## Get only regional cortical thickness in chronic pain
res_CP_MDD_brain_structure_regional_cortical_thickness <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Cortical Regional Thickness") & (res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
dk_cortical_regions <- dk$palette
## Remove "corpus callosum" and "temporal pole" as they are not availalbe on UKB
dk_cortical_regions <- names(dk_cortical_regions)[!names(dk_cortical_regions) %in% c("corpus callosum", "temporal pole")]
res_CP_MDD_brain_structure_regional_cortical_thickness$regions_ggseg <- rep(dk_cortical_regions, 3)
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_cortical_thickness[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "All")] <- "Depression: Full Sample"
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "Female")] <- "Depression: Female Sample"
res_CP_MDD_brain_structure_regional_cortical_thickness$group[(res_CP_MDD_brain_structure_regional_cortical_thickness$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_cortical_thickness$sample == "Male")] <- "Depression: Male Sample"
regional_cortical_thickness_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_cortical_thickness$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_cortical_thickness$beta,
groups = res_CP_MDD_brain_structure_regional_cortical_thickness$group
)
## Order groups
regional_cortical_thickness_ggseg$groups <- ordered(regional_cortical_thickness_ggseg$groups, levels = c("Depression: Full Sample", "Depression: Female Sample", "Depression: Male Sample"))
## Only display one hemisphere ase resutls are unilateral
p3 <- regional_cortical_thickness_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = dk,
hemi = "right",
aes(fill = `Standardized β`)) +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal()
patchwork_cortical_MDD <- p1/p2/p3
## Get only regional sub cortical volume
res_CP_MDD_brain_structure_regional_subcortical_volume <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "Subcortical Volumes") & (res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
sub_cortical_regions <- c("thalamus proper","caudate", "putamen", "pallidum", "hippocampus", "amygdala", "accumbens area")
res_CP_MDD_brain_structure_regional_subcortical_volume$regions_ggseg <- sub_cortical_regions
## Compare name columns as sanity check
#res_CP_MDD_brain_structure_regional_subcortical_volume[c("regions_ggseg", "brain_phenotype")]
## Create informative groups
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "All")] <- "Depression: Full Sample"
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "Female")] <- "Depression: Female Sample"
res_CP_MDD_brain_structure_regional_subcortical_volume$group[(res_CP_MDD_brain_structure_regional_subcortical_volume$disorder == "recurrent_depression") & (res_CP_MDD_brain_structure_regional_subcortical_volume$sample == "Male")] <- "Depression: Male Sample"
regional_subcortical_volume_ggseg <- tibble(
region = res_CP_MDD_brain_structure_regional_subcortical_volume$regions_ggseg,
"Standardized β" = res_CP_MDD_brain_structure_regional_subcortical_volume$beta,
groups = res_CP_MDD_brain_structure_regional_subcortical_volume$group
)
## Order groups
regional_subcortical_volume_ggseg$groups <- ordered(regional_subcortical_volume_ggseg$groups, levels = c("Chronic Pain: Full Sample", "Chronic Pain: Female Sample", "Chronic Pain: Male Sample", "Depression: Full Sample", "Depression: Female Sample", "Depression: Male Sample"))
ggplot() +
geom_brain(atlas = aseg,
hemi = "right") +
scale_fill_brain2(wes_palette("Darjeeling1",8,type = "continuous")) +
theme_minimal()
p4 <- regional_subcortical_volume_ggseg %>%
group_by(groups) %>%
ggplot() +
geom_brain(atlas = aseg,
aes(fill = `Standardized β`),
hemi = "left") +
facet_wrap(~groups) +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
theme_minimal() +
theme(panel.spacing = unit(22, "lines"))
(p1 / p2 / p3 / p4) + plot_annotation(tag_levels = 'A') & theme(strip.text.x = element_text(size = 20), legend.text = element_text(size = 10), legend.title = element_text(size = 15), plot.tag = element_text(size = 30))
## Get only indidual MD tract measures
res_CP_MDD_brain_structure_regional_MD <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "MD Tracts") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain" | res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
## Get only individual FA tract measures
res_CP_MDD_brain_structure_regional_FA <- res_CP_MDD_brain_structure_no_balanced[(res_CP_MDD_brain_structure_no_balanced$brain_structure_type == "FA Tracts") & (res_CP_MDD_brain_structure_no_balanced$disorder == "chronic_pain" | res_CP_MDD_brain_structure_no_balanced$disorder == "recurrent_depression"),]
## Get HEX colour to represent Beta scores of each tract in each sample
## Get heatmap of MD and FA measures for individual DTI tracts
p1 <- ggplot(res_CP_MDD_brain_structure_regional_MD, aes(x =brain_phenotype, y = sample, fill = beta)) +
geom_tile() +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red') +
facet_grid(. ~ disorder)
p2 <- ggplot(res_CP_MDD_brain_structure_regional_FA, aes(x =brain_phenotype, y = sample, fill = beta)) +
geom_tile() +
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red')+
facet_grid(. ~ disorder)
# get plot build
build <- ggplot_build(p1)
# select hex value and x-value data
hex_df <- build$data[[1]][, c("fill", "PANEL", "y", "x")]
# order hex value data
hex_df_ordered_1 <- hex_df[with(hex_df, order(PANEL, y, x)), ]
## Add tract, sample and disorder name
hex_df_ordered_1$tract <- sort(unique(res_CP_MDD_brain_structure_regional_MD$brain_phenotype))
hex_df_ordered_1$sample <- c(rep("All", 15), rep("Female",15), rep("Male", 15))
hex_df_ordered_1$disorder <- c(rep("CP", 45), rep("MDD", 45))
# get plot build
build <- ggplot_build(p2)
# select hex value and x-value data
hex_df <- build$data[[1]][, c("fill", "PANEL", "y", "x")]
# order hex value data
hex_df_ordered_2 <- hex_df[with(hex_df, order(PANEL, y, x)), ]
## Add tract, sample and disorder name
hex_df_ordered_2$tract <- sort(unique(res_CP_MDD_brain_structure_regional_FA$brain_phenotype))
hex_df_ordered_2$sample <- c(rep("All", 15), rep("Female",15), rep("Male", 15))
hex_df_ordered_2$disorder <- c(rep("CP", 45), rep("MDD", 45))
## Plot resutls
brain_structure_gg = ggplot(brain_structure_CP_all, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`)) +
geom_point(aes(y=beta),size=2) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
scale_colour_gradientn(colours = pal_discrete) +
labs(x = "Brain Structure Phenotype",
y = "Standardised effect size",
title = "Chronic pain and brain structures in UK Biobank",
colour = "Nominal P-value",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
## Plot resutls
brain_structure_gg = ggplot(brain_structure_CP_sex_stratified, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Chronic pain and brain structures in UK Biobank: sex-stratified",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
brain_structure_gg = ggplot(brain_structure_MDD_all, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`)) +
geom_point(size=2) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
scale_colour_gradientn(colours = pal_discrete) +
labs(x = "Brain Structure Phenotype",
y = "Standardised effect size",
title = "Major depressive disorder and brain structures in UK Biobank",
colour = "Nominal P-value",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5))  +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
## Plot resutls
brain_structure_gg = ggplot(brain_structure_MDD_sex_stratified, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Depression and brain structures in UK Biobank: sex-stratified",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
res_CP_MDD_brain_structure_balanced_CP_f <- res_CP_MDD_brain_structure[(res_CP_MDD_brain_structure$sample == "Female"| res_CP_MDD_brain_structure$sample == "Balanced:Female") & res_CP_MDD_brain_structure$disorder == "chronic_pain",]
res_CP_MDD_brain_structure_balanced_CP_m <- res_CP_MDD_brain_structure[(res_CP_MDD_brain_structure$sample == "Male"| res_CP_MDD_brain_structure$sample == "Balanced:Male") & res_CP_MDD_brain_structure$disorder == "chronic_pain",]
res_CP_MDD_brain_structure_balanced_MDD_f <- res_CP_MDD_brain_structure[(res_CP_MDD_brain_structure$sample == "Female"| res_CP_MDD_brain_structure$sample == "Balanced:Female") & res_CP_MDD_brain_structure$disorder == "recurrent_depression",]
res_CP_MDD_brain_structure_balanced_MDD_m <- res_CP_MDD_brain_structure[(res_CP_MDD_brain_structure$sample == "Male"| res_CP_MDD_brain_structure$sample == "Balanced:Male") & res_CP_MDD_brain_structure$disorder == "recurrent_depression",]
res_comorbidity_brain_structure_balanced_f <- res_comorbidity_brain_structure[res_comorbidity_brain_structure$sample == "Balanced:Female",]
res_comorbidity_brain_structure_balanced_m <- res_comorbidity_brain_structure[res_comorbidity_brain_structure$sample == "Balanced:Male",]
## Order levels of brain phenotpyes in oder of beta values to make plot neat
res_CP_MDD_brain_structure_balanced_CP_f$brain_phenotype_plot <- reorder(res_CP_MDD_brain_structure_balanced_CP_f$brain_phenotype_plot, -res_CP_MDD_brain_structure_balanced_CP_f$beta)
res_CP_MDD_brain_structure_balanced_CP_m$brain_phenotype_plot <- reorder(res_CP_MDD_brain_structure_balanced_CP_m$brain_phenotype_plot, -res_CP_MDD_brain_structure_balanced_CP_m$beta)
res_CP_MDD_brain_structure_balanced_MDD_f$brain_phenotype_plot <- reorder(res_CP_MDD_brain_structure_balanced_MDD_f$brain_phenotype_plot, -res_CP_MDD_brain_structure_balanced_MDD_f$beta)
res_CP_MDD_brain_structure_balanced_MDD_m$brain_phenotype_plot <- reorder(res_CP_MDD_brain_structure_balanced_MDD_m$brain_phenotype_plot, -res_CP_MDD_brain_structure_balanced_MDD_m$beta)
brain_structure_gg = ggplot(res_CP_MDD_brain_structure_balanced_CP_f, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Chronic pain in full sample VS balanced sample: Females",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
brain_structure_gg = ggplot(res_CP_MDD_brain_structure_balanced_CP_m, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Chronic pain in full sample VS balanced sample: Males",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
brain_structure_gg = ggplot(res_CP_MDD_brain_structure_balanced_MDD_f, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Depression in full sample VS balanced sample: Females",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
brain_structure_gg = ggplot(res_CP_MDD_brain_structure_balanced_MDD_m, aes(x=brain_phenotype_plot, y=beta, shape=`Adjusted p-value < 0.05`,colour=sample)) +
geom_point(aes(y=beta),size=3, alpha = 0.5) +
geom_errorbar(aes(ymin=Lower_95CI, ymax=Upper_95CI), width=0, alpha = 0.5) +
theme_minimal() +
geom_hline(yintercept=0, linetype="dashed", color = "black") +
coord_flip() +
labs(x = "",
y = "Standardised effect size",
title = "Depression in full sample VS balanced sample: Males",
colour = "Sex",
shape = "Adjusted p-value < 0.05") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_color_manual(values = pal_continuous) +
ggforce::facet_col(facets = vars(brain_structure_type),
scales = "free_y",
space = "free")
brain_structure_gg
sum(res_comorbidity_brain_structure_all_save$p.adjust < 0.05)
sum(res_comorbidity_brain_structure_female_save$p.adjust < 0.05)
sum(res_comorbidity_brain_structure_male_save$p.adjust < 0.05)
sum(brain_structure_CP_all$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_CP_female$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_CP_male$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_MDD_all$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_MDD_female$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_MDD_male$`Adjusted p-value < 0.05` == "Yes")
cat("Unbalanced comorbidity:")
sum(res_comorbidity_brain_structure_female_save$p.adjust < 0.05)
sum(res_comorbidity_brain_structure_male_save$p.adjust < 0.05)
cat("Balanced comorbidity:")
sum(res_comorbidity_brain_structure_balanced_f$p.adjust < 0.05)
sum(res_comorbidity_brain_structure_balanced_m$p.adjust < 0.05)
cat("Unbalanced CP:")
sum(brain_structure_CP_female$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_CP_male$`Adjusted p-value < 0.05` == "Yes")
cat("Balanced CP:")
sum(res_CP_MDD_brain_structure_balanced_CP_f$p.adjust < 0.05)
sum(res_CP_MDD_brain_structure_balanced_CP_m$p.adjust < 0.05)
cat("Unbalanced MDD:")
sum(brain_structure_MDD_female$`Adjusted p-value < 0.05` == "Yes")
sum(brain_structure_MDD_male$`Adjusted p-value < 0.05` == "Yes")
cat("Balanced MDD:")
sum(res_CP_MDD_brain_structure_balanced_MDD_f$p.adjust < 0.05)
sum(res_CP_MDD_brain_structure_balanced_MDD_m$p.adjust < 0.05)
