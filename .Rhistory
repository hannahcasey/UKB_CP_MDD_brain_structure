q <- pa <- rep.int(min(n * p/i), n)
for (j in (n - 1L):2L) {
ij <- seq_len(n - j + 1L)
i2 <- (n - j + 2L):n
q1 <- min(j * p[i2]/(2L:j))
q[ij] <- pmin(j * p[ij], q1)
q[i2] <- q[n - j + 1L]
pa <- pmax(pa, q)
}
pmax(pa, p)[if (lp < n) ro[1L:lp] else ro]
}, hochberg = {
i <- lp:1L
o <- order(p, decreasing = TRUE)
ro <- order(o)
pmin(1, cummin((n + 1L - i) * p[o]))[ro]
}, BH = {
i <- lp:1L
o <- order(p, decreasing = TRUE)
ro <- order(o)
pmin(1, cummin(n/i * p[o]))[ro]
}, BY = {
i <- lp:1L
o <- order(p, decreasing = TRUE)
ro <- order(o)
q <- sum(1/(1L:n))
pmin(1, cummin(q * n/i * p[o]))[ro]
}, none = p)
p0
}
MR_res$p.adjust <- 0
MR_res[MR_res$method == "Inverse variance weighted", "p.adjust"] <- p.adjust.new(MR_res[MR_res$method == "Inverse variance weighted", "pval"], n = (nrow(MR_res)/4), method = "fdr")
MR_res[MR_res$method == "Simple median", "p.adjust"] <- p.adjust.new(MR_res[MR_res$method == "Simple median", "pval"], n = (nrow(MR_res)/4), method = "fdr")
MR_res[MR_res$method %in% c("MR Egger", "MR Egger (Simex Correction)"), "p.adjust"] <- p.adjust.new(MR_res[MR_res$method %in% c("MR Egger", "MR Egger (Simex Correction)"), "pval"], n = (nrow(MR_res)/4), method = "fdr")
MR_res[MR_res$method == "Weighted median", "p.adjust"] <- p.adjust.new(MR_res[MR_res$method == "Weighted median", "pval"], n = (nrow(MR_res)/4), method = "fdr")
# Include yes/no column to determine shape based on p-value
MR_res$Significance <- 0
MR_res[MR_res$pval < 0.05, "Significance"] <- "Nominally Significant"
MR_res[MR_res$pval > 0.05, "Significance"] <- "Not Significant"
MR_res[MR_res$p.adjust < 0.05, "Significance"] <- "Statistically Significant"
## round numbers
MR_res_rounded <- data.frame(lapply(MR_res, function(y) if(is.numeric(y)) round(y, 2) else y))
## Refine resutls table
MR_res_plot <- MR_res_rounded %>%
select(analysis, method, b, se,nsnp,pval, p.adjust, Significance) %>%
rename(`MR method` = method,
`MR analysis` = analysis,
Beta = b,
SE = se,
`p-value` = pval,
`Adjusted P-value` = `p.adjust`,
`Number of SNPs` = nsnp)
## Plot all results in table
table <- flextable(MR_res_plot) %>%
align(part = "all") %>% # left align
set_caption(caption = "All Two-Sample Mendelian Randomisation Results") %>%
font(fontname = "Calibri (Body)", part = "all") %>%
fontsize(size = 10, part = "body") %>%
theme_booktabs() %>%
autofit() %>%
fit_to_width(7.5) %>%
colformat_num(digits = 2)
table
plots_1 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA", pattern = ".jpg", full.names = T)
plots_2 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/olink_CVD", pattern = ".jpg", full.names = T)
plots <- c(plots_1, plots_2)
plots <- sort(plots)
for(i in plots){
i_spaced <- gsub("leave_one_out", "Leave one out", i)
number <- which(plots == i)
analysis <- word(i_spaced, 11, sep = "/")
analysis <- word(analysis, 1, sep = "_")
analysis <- str_to_sentence(analysis)
exposure <- word(i_spaced, 7, sep = "_")
outcome <- word(i_spaced, 8, sep = "_")
title <- paste(exposure, "->", outcome)
title <- gsub(".jpg", "", title)
cat("<center>")
cat(paste0("![](", i, "){height=150 width=60% }"))
cat("\
&nbsp;
\
&nbsp;")
cat(paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"))
cat("<center>")
}
## Two-sample medelian randomisation f and dillution statistic
olink_f <- read.csv("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/olink_CVD/F_I2GX_stats.csv")
CRP_glycA_f <- read.csv("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA/F_I2GX_stats.csv")
MR_ft <- rbind(olink_f, CRP_glycA_f)
MR_ft <- MR_ft %>%
select(analysis, F, I2GX) %>%
rename(Analysis = analysis)
table <- flextable(MR_ft) %>%
align(part = "all") %>% # left align
set_caption(caption = "All F-statistics and I^2 statistic from Two-sample Mendelian Randomisation Results") %>%
font(fontname = "Calibri (Body)", part = "all") %>%
fontsize(size = 10, part = "body") %>%
theme_booktabs() %>%
autofit() %>%
fit_to_width(7.5) %>%
colformat_num(digits = 2)
table
## Two-sample medelian randomisation pleotropy test
olink_intercept <- read.csv("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/olink_CVD/MR_inflam_results_pleiotropy_df.csv")
CRP_glycA_intercept <- read.csv("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA/MR_CRP_glycA_results_pleiotropy_df.csv")
MR_intercept <- rbind(olink_intercept, CRP_glycA_intercept)
MR_intercept <- MR_intercept %>%
select(analysis, egger_intercept, se, pval) %>%
rename(Analysis = analysis,
'Egger Intercept' = egger_intercept,
SE = se,
`P value` = pval) %>%
drop_na()
table <- flextable(MR_intercept) %>%
align(part = "all") %>% # left align
set_caption(caption = "All Pleotropy in Two-sample Mendelian Randomisation Results") %>%
font(fontname = "Calibri (Body)", part = "all") %>%
fontsize(size = 10, part = "body") %>%
theme_booktabs() %>%
autofit() %>%
fit_to_width(7.5) %>%
colformat_num(digits = 2)
table
plots <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/colocalization/locuszoom/", pattern = ".jpg", full.names = T)
for(i in plots){
number <- which(plots == i)
analysis <- word(i, 12, sep = "/")
top <- word(analysis, 2, sep = "_")
bottom <- word(analysis, 1, sep = "_")
title <- paste0("Colocalisation of ", top, " (top) and ","s", bottom, " (bottom)")
cat("<center>")
cat(paste0("![](", i, "){height=700 width=100% }"))
cat("\
&nbsp;
\
&nbsp;")
cat(paste0("**Figure S2.4.", number, ".", title,"**"))
cat("<center>")
}
paste0("**Figure S2.3.", number," ",analysis, " ", title,"**")
cat("<center>")
cat(paste0("![",paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"),"](", i, "){height=150 width=49% }"))
# cat("\
# &nbsp;
# \
# &nbsp;")
# cat(paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"))
cat("<center>")
for(i in plots){
i_spaced <- gsub("leave_one_out", "Leave one out", i)
number <- which(plots == i)
analysis <- word(i_spaced, 11, sep = "/")
analysis <- word(analysis, 1, sep = "_")
analysis <- str_to_sentence(analysis)
exposure <- word(i_spaced, 7, sep = "_")
outcome <- word(i_spaced, 8, sep = "_")
title <- paste(exposure, "->", outcome)
title <- gsub(".jpg", "", title)
#cat("<center>")
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49% }"))
# cat("\
# &nbsp;
# \
# &nbsp;")
# cat(paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"))
#cat("<center>")
}
analysis
i_spaced
word(i_spaced, 11, sep = "/")
word(i_spaced, 10, sep = "/")
word(i_spaced, 12, sep = "/")
plots
plots_1 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA", pattern = ".jpg", full.names = T)
plots_2 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/olink_CVD", pattern = ".jpg", full.names = T)
c(plots_1, plots_2)
plots <- c(plots_1, plots_2)
plots <- sort(plots)
plots
plots_1 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA", pattern = ".jpg", full.names = T)
plots_2 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/olink_CVD", pattern = ".jpg", full.names = T)
plots <- c(plots_1, plots_2)
plots <- sort(plots)
for(i in plots){
i_spaced <- gsub("leave_one_out", "Leave one out", i)
number <- which(plots == i)
analysis <- word(i_spaced, 11, sep = "/")
analysis <- word(analysis, 1, sep = "_")
analysis <- str_to_sentence(analysis)
exposure <- word(i_spaced, 7, sep = "_")
outcome <- word(i_spaced, 8, sep = "_")
title <- paste(exposure, "->", outcome)
title <- gsub(".jpg", "", title)
#cat("<center>")
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49% }"))
# cat("\
# &nbsp;
# \
# &nbsp;")
# cat(paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"))
#cat("<center>")
}
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49% }"))
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49%}<caption>"))
for(i in plots){
i_spaced <- gsub("leave_one_out", "Leave one out", i)
number <- which(plots == i)
analysis <- word(i_spaced, 11, sep = "/")
analysis <- word(analysis, 1, sep = "_")
analysis <- str_to_sentence(analysis)
exposure <- word(i_spaced, 7, sep = "_")
outcome <- word(i_spaced, 8, sep = "_")
title <- paste(exposure, "->", outcome)
title <- gsub(".jpg", "", title)
#cat("<center>")
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49%} <caption> "))
# cat("\
# &nbsp;
# \
# &nbsp;")
# cat(paste0("**Figure S2.3.", number," ",analysis, " ", title,"**"))
#cat("<center>")
}
cat(paste0("![",paste0("Figure S2.3.", number," ",analysis, " ", title),"](", i, "){height=150 width=49%}<caption> "))
seq(1:length(plots), 2)
length(plots)
seq(1,length(plots), 2)
paste0("Figure S2.3.", number," ",analysis, " ", title)
i
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced, 11, sep = "/")
analysis_1 <- word(analysis, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis)
exposure_1 <- word(i_spaced, 7, sep = "_")
outcome_1 <- word(i_spaced, 8, sep = "_")
title_1 <- paste(exposure, "->", outcome)
title_1 <- gsub(".jpg", "", title)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced, 11, sep = "/")
analysis_2 <- word(analysis, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis)
exposure_2 <- word(i_spaced, 7, sep = "_")
outcome_2 <- word(i_spaced, 8, sep = "_")
title_2 <- paste(exposure, "->", outcome)
title_2 <- gsub(".jpg", "", title)
cat(paste0("![](", plot1, "){height=150 width=49%}")) cat(paste0("![](", plot2, "){height=150 width=49%}"))
plot1
seq(1,length(plots), 2)
plot1
i
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced, 11, sep = "/")
analysis_1 <- word(analysis, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis)
exposure_1 <- word(i_spaced, 7, sep = "_")
outcome_1 <- word(i_spaced, 8, sep = "_")
title_1 <- paste(exposure, "->", outcome)
title_1 <- gsub(".jpg", "", title)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced, 11, sep = "/")
analysis_2 <- word(analysis, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis)
exposure_2 <- word(i_spaced, 7, sep = "_")
outcome_2 <- word(i_spaced, 8, sep = "_")
title_2 <- paste(exposure, "->", outcome)
title_2 <- gsub(".jpg", "", title)
cat(paste0("![](", plot1, "){height=150 width=49%}")) cat(paste0("![](", plot2, "){height=150 width=49%}"))
plot1
plots[i]
i <- 1
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced, 11, sep = "/")
analysis_1 <- word(analysis, 1, sep = "_")
analysis_1 <- word(analysis, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis)
exposure_1 <- word(i_spaced, 7, sep = "_")
exposure_1 <- word(i_spaced, 7, sep = "_")
outcome_1 <- word(i_spaced, 8, sep = "_")
title_1 <- paste(exposure, "->", outcome)
title_1 <- gsub(".jpg", "", title)
title_1 <- gsub(".jpg", "", title)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced, 11, sep = "/")
analysis_2 <- word(analysis, 1, sep = "_")
analysis_2 <- word(analysis, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis)
exposure_2 <- word(i_spaced, 7, sep = "_")
outcome_2 <- word(i_spaced, 8, sep = "_")
title_2 <- paste(exposure, "->", outcome)
title_2 <- gsub(".jpg", "", title)
i_spaced_2
title_2
cat(paste0("![](", plot1, "){height=150 width=49%}")) cat(paste0("![](", plot2, "){height=150 width=49%}"))
paste0("![](", plot1, "){height=150 width=49%}")) cat(paste0("![](", plot2, "){height=150 width=49%}")
paste0("![](", plot1, "){height=150 width=49%}"
)
cat(paste0("![](", plot1, "){height=150 width=49%}![](", plot2, "){height=150 width=49%}"))
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced, 7, sep = "_")
outcome_2 <- word(i_spaced, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=150 width=49%}![](", plot2, "){height=150 width=49%}"))
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1))
}
plots_1 <- list.files("~/Desktop/PhD/projects/CP_MDD_inflammation_MR/output/two_sample/CRP_glycA", pattern = ".jpg", full.names = T)
paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"               Figure S2.3.", number_1," ",analysis_1, " ", title_1)
library(kableExtra)
library(dplyr)
library(flextable)
library(stringr)
library(tidyr)
knitr::opts_chunk$set(echo = FALSE,
include = TRUE,
message = FALSE,
warning = FALSE,
error = FALSE)
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=280}![](", plot2, "){height=280} \\linebreak "))
cat("\\ ")
cat("\\linebreak")
cat("\\linebreak")
cat("\\linebreak")
cat("\\ ")
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"     Figure S2.3.", number_1," ",analysis_1, " ", title_1))
cat("\\ ")
cat("\\linebreak")
cat("\\linebreak")
cat("\\linebreak")
cat("\\ ")
}
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=280}![](", plot2, "){height=280}"))
cat("\\ ")
cat("\\linebreak")
cat("\\linebreak")
cat("\\linebreak")
cat("\\ ")
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"     Figure S2.3.", number_1," ",analysis_1, " ", title_1))
cat("\\ ")
cat("\\linebreak")
cat("\\linebreak")
cat("\\linebreak")
cat("\\ ")
}
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=280}![](", plot2, "){height=280} \\"))
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"     Figure S2.3.", number_1," ",analysis_1, " ", title_1))
}
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=280}![](", plot2, "){height=280} <br />"))
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"     Figure S2.3.", number_1," ",analysis_1, " ", title_1))
}
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){height=280}![](", plot2, "){height=280} <br /> "))
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"     Figure S2.3.", number_1," ",analysis_1, " ", title_1))
}
for(i in seq(1,length(plots), 2)){
plot1 <- plots[i]
plot2 <- plots[i + 1]
i_spaced_1 <- gsub("leave_one_out", "Leave one out", plot1)
number_1 <- which(plots == plot1)
analysis_1 <- word(i_spaced_1, 11, sep = "/")
analysis_1 <- word(analysis_1, 1, sep = "_")
analysis_1 <- str_to_sentence(analysis_1)
exposure_1 <- word(i_spaced_1, 7, sep = "_")
outcome_1 <- word(i_spaced_1, 8, sep = "_")
title_1 <- paste(exposure_1, "->", outcome_1)
title_1 <- gsub(".jpg", "", title_1)
i_spaced_2 <- gsub("leave_one_out", "Leave one out", plot2)
number_2 <- which(plots == plot2)
analysis_2 <- word(i_spaced_2, 11, sep = "/")
analysis_2 <- word(analysis_2, 1, sep = "_")
analysis_2 <- str_to_sentence(analysis_2)
exposure_2 <- word(i_spaced_2, 7, sep = "_")
outcome_2 <- word(i_spaced_2, 8, sep = "_")
title_2 <- paste(exposure_2, "->", outcome_2)
title_2 <- gsub(".jpg", "", title_2)
cat(paste0("![](", plot1, "){width=245}![](", plot2, "){width=250}"))
cat("  \n")
cat(paste0("Figure S2.3.", number_1," ",analysis_1, " ", title_1,"   Figure S2.3.", number_2," ",analysis_2, " ", title_2))
}
