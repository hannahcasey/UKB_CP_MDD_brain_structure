dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Volumes",
id_col = "f.eid")
cortical_volume_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_volume_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(cortical_volume_general) -1,
structural_subtype = "Cortical Volume Global and Lobal Measures")
cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.adjust"] <- cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.value"]
## Cortical Thickness
hemisphere_interaction_group(dependent = cortical_thickness_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness")
cortical_thickness_assoc <- bilateral_structure_assoc_group(dependent = cortical_thickness_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness",
id_col = "f.eid")
cortical_thickness_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_thickness_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(cortical_thickness_general) -1,
structural_subtype = "Cortical Thickness Global and Lobal Measures")
cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.adjust"] <- cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.value"]
## Cortical Area
hemisphere_interaction_group(dependent = cortical_area_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas")
cortical_area_assoc <- bilateral_structure_assoc_group(dependent = cortical_area_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas",
id_col = "f.eid")
cortical_area_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_area_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(cortical_area_general) -1,
structural_subtype = "Cortical Area Global and Lobal Measures")
cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.adjust"] <- cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.value"]
##FA
hemisphere_interaction_group(dependent = FA_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts")
FA_bilateral_assoc <- bilateral_structure_assoc_group(dependent = FA_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts",
id_col = "f.eid")
FA_unilateral_assoc <- unilateral_structure_assoc_group(dependent = FA_unilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(FA_unilateral),
structural_subtype = "FA Tracts")
FA_general_assoc <- unilateral_structure_assoc_group(dependent = FA_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(FA_general) -1,
structural_subtype = "FA General Measures")
FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.adjust"] <- FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.value"]
##MD
hemisphere_interaction_group(dependent = MD_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts")
MD_bilateral_assoc <- bilateral_structure_assoc_group(dependent = MD_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts",
id_col = "f.eid")
MD_unilateral_assoc <- unilateral_structure_assoc_group(dependent = MD_unilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(MD_unilateral),
structural_subtype = "MD Tracts")
MD_general_assoc <- unilateral_structure_assoc_group(dependent = MD_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex)),
n_comparisons = length(MD_general) -1,
structural_subtype = "MD General Measures")
MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.adjust"] <- MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.value"]
## Combine association results
assign(paste0("all_comorbidity_structure_assoc_", sex), do.call("rbind", list(subcortical_volume_assoc, cortical_volume_assoc, cortical_area_assoc, cortical_thickness_assoc, cortical_area_general_assoc, cortical_thickness_general_assoc, cortical_volume_general_assoc, FA_bilateral_assoc, FA_general_assoc, FA_unilateral_assoc, MD_bilateral_assoc, MD_general_assoc, MD_unilateral_assoc)))
}
## Add column indicating methylation score p-value threshold
all_comorbidity_structure_assoc_females$disorder<- "comorbidity"
all_comorbidity_structure_assoc_males$disorder<- "comorbidity"
for (site in c("Newcastle" ,"Cheadle", "Reading")){
for (sex in c("females", "males")){
##Subcortical Volume
## flag if any bilateral hemisphere measurements need to be analyzed separately
hemisphere_interaction_group(dependent = sub_cortical_volume_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(sub_cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Subcortical Volumes")
subcortical_volume_assoc <- bilateral_structure_assoc_group(dependent = sub_cortical_volume_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(sub_cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Subcortical Volumes",
id_col = "f.eid")
## Cortical Volume
hemisphere_interaction_group(dependent = cortical_volume_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Volumes")
cortical_volume_assoc <- bilateral_structure_assoc_group(dependent =  cortical_volume_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Volumes",
id_col = "f.eid")
cortical_volume_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_volume_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(cortical_volume_general) -1,
structural_subtype = "Cortical Volume Global and Lobal Measures")
cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.adjust"] <- cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.value"]
## Cortical Thickness
hemisphere_interaction_group(dependent = cortical_thickness_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness")
cortical_thickness_assoc <- bilateral_structure_assoc_group(dependent = cortical_thickness_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness",
id_col = "f.eid")
cortical_thickness_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_thickness_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(cortical_thickness_general) -1,
structural_subtype = "Cortical Thickness Global and Lobal Measures")
cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.adjust"] <- cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.value"]
## Cortical Area
hemisphere_interaction_group(dependent = cortical_area_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas")
cortical_area_assoc <- bilateral_structure_assoc_group(dependent = cortical_area_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas",
id_col = "f.eid")
cortical_area_general_assoc <- unilateral_structure_assoc_group(dependent = cortical_area_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_T1_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(cortical_area_general) -1,
structural_subtype = "Cortical Area Global and Lobal Measures")
cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.adjust"] <- cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.value"]
##FA
hemisphere_interaction_group(dependent = FA_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts")
FA_bilateral_assoc <- bilateral_structure_assoc_group(dependent = FA_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts",
id_col = "f.eid")
FA_unilateral_assoc <- unilateral_structure_assoc_group(dependent = FA_unilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(FA_unilateral),
structural_subtype = "FA Tracts")
FA_general_assoc <- unilateral_structure_assoc_group(dependent = FA_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(FA_general) -1,
structural_subtype = "FA General Measures")
FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.adjust"] <- FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.value"]
##MD
hemisphere_interaction_group(dependent = MD_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts")
MD_bilateral_assoc <- bilateral_structure_assoc_group(dependent = MD_bilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",sex, "_", site)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts",
id_col = "f.eid")
MD_unilateral_assoc <- unilateral_structure_assoc_group(dependent = MD_unilateral,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(MD_unilateral),
structural_subtype = "MD Tracts")
MD_general_assoc <- unilateral_structure_assoc_group(dependent = MD_general,
independent = "comorbidity_group",
covariates = brain_structure_covariates_diffusion_no_sex_site,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",sex, "_", site)),
n_comparisons = length(MD_general) -1,
structural_subtype = "MD General Measures")
MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.adjust"] <- MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.value"]
## Combine association results
assign(paste0("all_comorbidity_structure_assoc_", sex,  "_by_site"), do.call("rbind", list(subcortical_volume_assoc, cortical_volume_assoc, cortical_area_assoc, cortical_thickness_assoc, cortical_area_general_assoc, cortical_thickness_general_assoc, cortical_volume_general_assoc, FA_bilateral_assoc, FA_general_assoc, FA_unilateral_assoc, MD_bilateral_assoc, MD_general_assoc, MD_unilateral_assoc)))
}
## Add column indicating site
all_comorbidity_structure_assoc_males_by_site$site <- site
all_comorbidity_structure_assoc_females_by_site$site <- site
if (site == "Newcastle"){
assign("all_comorbidity_structure_assoc_males_site", all_comorbidity_structure_assoc_males_by_site)
assign("all_comorbidity_structure_assoc_females_site", all_comorbidity_structure_assoc_females_by_site)
}else{
assign("all_comorbidity_structure_assoc_males_site" , rbind(all_comorbidity_structure_assoc_males_site, all_comorbidity_structure_assoc_males_by_site))
assign("all_comorbidity_structure_assoc_females_site", rbind(all_comorbidity_structure_assoc_females_site, all_comorbidity_structure_assoc_females_by_site))
}
}
UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced <- UKB_CP_MDD_imaging_covariates %>%
select(f.eid, BMI, sex, age, recurrent_depression, ICV, volume_paracentral_right, assessment_centre_first_imaging, sub_cortical_volume_thalamus_left, MD_acoustic_radiation_left) %>%
na.omit()
UKB_CP_MDD_imaging_covariates_chronic_pain_balanced <- UKB_CP_MDD_imaging_covariates %>%
select(f.eid, BMI, sex, age, chronic_pain, volume_paracentral_right, assessment_centre_first_imaging, sub_cortical_volume_thalamus_left, MD_acoustic_radiation_left) %>%
na.omit()
UKB_CP_MDD_imaging_covariates_CPMDD_balanced <- UKB_CP_MDD_imaging_covariates %>%
select(f.eid, BMI, sex, age, comorbidity_group, volume_paracentral_right, assessment_centre_first_imaging, sub_cortical_volume_thalamus_left, MD_acoustic_radiation_left) %>%
na.omit()
## Get same number of male/female cases and controls
## Get number of male/female cases/controls
n_depression_cases_male <- sum((UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 1), na.rm = TRUE)
n_depression_cases_female <- sum((UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 1), na.rm = TRUE)
n_depression_controls_male <- sum((UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 0), na.rm = TRUE)
n_depression_controls_female <- sum((UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 0), na.rm = TRUE)
n_CP_cases_male <- sum((UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 1), na.rm = TRUE)
n_CP_cases_female <- sum((UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 1), na.rm = TRUE)
n_CP_controls_male <- sum((UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 0), na.rm = TRUE)
n_CP_controls_female <- sum((UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 0), na.rm = TRUE)
n_CPMDD_male <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + Chronic Pain"), na.rm = TRUE)
n_CPMDD_female <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + Chronic Pain"), na.rm = TRUE)
n_CPnoMDD_male <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + Chronic Pain"), na.rm = TRUE)
n_CPnoMDD_female <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + Chronic Pain"), na.rm = TRUE)
n_noCPMDD_male <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + No Chronic Pain"), na.rm = TRUE)
n_noCPMDD_female <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + No Chronic Pain"), na.rm = TRUE)
n_noCPnoMDD_male <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + No Chronic Pain"), na.rm = TRUE)
n_noCPnoMDD_female <- sum((UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + No Chronic Pain"), na.rm = TRUE)
## Sample random female/male cases/controls to remove
row_n_depression_female_cases_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 1), (n_depression_cases_female - n_depression_cases_male), replace = FALSE, prob = NULL)
row_n_depression_male_controls_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression == 0), (n_depression_controls_male - n_depression_controls_female), replace = FALSE, prob = NULL)
row_n_CP_female_cases_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 1), (n_CP_cases_female - n_CP_cases_male), replace = FALSE, prob = NULL)
row_n_CP_female_controls_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain == 0), (n_CP_controls_female - n_CP_controls_male), replace = FALSE, prob = NULL)
row_n_CPMDD_female_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + Chronic Pain"), (n_CPMDD_female - n_CPMDD_male), replace = FALSE, prob = NULL)
row_n_CPnoMDD_female_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + Chronic Pain"), (n_CPnoMDD_female - n_CPnoMDD_male), replace = FALSE, prob = NULL)
row_n_noCPMDD_female_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Female" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "Probable Recurrent MDD + No Chronic Pain"), (n_noCPMDD_female - n_noCPMDD_male), replace = FALSE, prob = NULL)
row_n_noCPnoMDD_male_exclude <- sample(which(UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex == "Male" & UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group == "No Probable Recurrent MDD + No Chronic Pain"), (n_noCPnoMDD_male - n_noCPnoMDD_female), replace = FALSE, prob = NULL)
## Remove cases/controls
UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced <- UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced[-c(row_n_depression_female_cases_exclude, row_n_depression_male_controls_exclude),]
UKB_CP_MDD_imaging_covariates_chronic_pain_balanced <- UKB_CP_MDD_imaging_covariates_chronic_pain_balanced[-c(row_n_CP_female_cases_exclude, row_n_CP_female_controls_exclude),]
UKB_CP_MDD_imaging_covariates_CPMDD_balanced <- UKB_CP_MDD_imaging_covariates_CPMDD_balanced[-c(row_n_CPMDD_female_exclude, row_n_CPnoMDD_female_exclude, row_n_noCPMDD_female_exclude, row_n_noCPnoMDD_male_exclude),]
## Double check that n of female/male cases/cotrols are equal in each disorder
table(UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$recurrent_depression, UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$sex)
table(UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$chronic_pain, UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$sex)
table(UKB_CP_MDD_imaging_covariates_CPMDD_balanced$comorbidity_group, UKB_CP_MDD_imaging_covariates_CPMDD_balanced$sex)
## Get sex-specific and sex-balanced dataframes
UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced_females <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_long_recurrent_depression_balanced_females <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced_males <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Male"),]
UKB_CP_MDD_imaging_covariates_long_recurrent_depression_balanced_males <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_recurrent_depression_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Male"),]
UKB_CP_MDD_imaging_covariates_chronic_pain_balanced_females <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_long_chronic_pain_balanced_females <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_chronic_pain_balanced_males <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Male"),]
UKB_CP_MDD_imaging_covariates_long_chronic_pain_balanced_males <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_chronic_pain_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Male"),]
UKB_CP_MDD_imaging_covariates_CPMDD_balanced_females <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_CPMDD_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_long_CPMDD_balanced_females <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_CPMDD_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Female"),]
UKB_CP_MDD_imaging_covariates_CPMDD_balanced_males <- UKB_CP_MDD_imaging_covariates[(UKB_CP_MDD_imaging_covariates$f.eid %in% UKB_CP_MDD_imaging_covariates_CPMDD_balanced$f.eid & UKB_CP_MDD_imaging_covariates$sex == "Male"),]
UKB_CP_MDD_imaging_covariates_long_CPMDD_balanced_males <- UKB_CP_MDD_imaging_covariates_long[(UKB_CP_MDD_imaging_covariates_long$f.eid %in% UKB_CP_MDD_imaging_covariates_CPMDD_balanced$f.eid & UKB_CP_MDD_imaging_covariates_long$sex == "Male"),]
## Loop through each disorder to carry out association analysis
for (sex in c("females", "males")){
for (disorder in c("chronic_pain", "recurrent_depression")){
##Subcortical Volume
## Flag if any bilateral hemisphere measurements need to be analyzed separately
hemisphere_interaction(dependent = sub_cortical_volume_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(sub_cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Subcortical Volumes")
subcortical_volume_assoc <- bilateral_structure_assoc(dependent = sub_cortical_volume_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(sub_cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Subcortical Volumes",
id_col = "f.eid")
## Cortical Volume
hemisphere_interaction(dependent = cortical_volume_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Volumes")
cortical_volume_assoc <- bilateral_structure_assoc(dependent = cortical_volume_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_volume_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Volumes",
id_col = "f.eid")
cortical_volume_general_assoc <- unilateral_structure_assoc(dependent = cortical_volume_general,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(cortical_volume_general) -1,
structural_subtype = "Cortical Volume Global and Lobal Measures")
cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.adjust"] <- cortical_volume_general_assoc[cortical_volume_general_assoc$brain_phenotype == "volume_global_cortical", "p.value"]
## Cortical Thickness
hemisphere_interaction(dependent = cortical_thickness_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness")
cortical_thickness_assoc <- bilateral_structure_assoc(dependent = cortical_thickness_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_thickness_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Thickness",
id_col = "f.eid")
cortical_thickness_general_assoc <- unilateral_structure_assoc(dependent = cortical_thickness_general,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(cortical_thickness_general) -1,
structural_subtype = "Cortical Thickness Global and Lobal Measures")
cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.adjust"] <- cortical_thickness_general_assoc[cortical_thickness_general_assoc$brain_phenotype == "thickness_global_cortical", "p.value"]
## Cortical Area
hemisphere_interaction(dependent = cortical_area_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas")
cortical_area_assoc <- bilateral_structure_assoc(dependent = cortical_area_bilateral,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(cortical_area_bilateral),
hemisphere_col = "hemi",
structural_subtype = "Cortical Regional Areas",
id_col = "f.eid")
cortical_area_general_assoc <- unilateral_structure_assoc(dependent = cortical_area_general,
independent = disorder,
covariates = brain_structure_covariates_T1_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(cortical_area_general) -1,
structural_subtype = "Cortical Area Global and Lobal Measures")
cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.adjust"] <- cortical_area_general_assoc[cortical_area_general_assoc$brain_phenotype == "area_global_cortical", "p.value"]
##FA
hemisphere_interaction(dependent = FA_bilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts")
FA_bilateral_assoc <- bilateral_structure_assoc(dependent = FA_bilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(FA_bilateral),
hemisphere_col = "hemi",
structural_subtype = "FA Tracts",
id_col = "f.eid")
FA_unilateral_assoc <- unilateral_structure_assoc(dependent = FA_unilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(FA_unilateral),
structural_subtype = "FA Tracts")
FA_general_assoc <- unilateral_structure_assoc(dependent = FA_general,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(FA_general) -1,
structural_subtype = "FA General Measures")
FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.adjust"] <- FA_general_assoc[FA_general_assoc$brain_phenotype == "FA_global", "p.value"]
##MD
hemisphere_interaction(dependent = MD_bilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts")
MD_bilateral_assoc <- bilateral_structure_assoc(dependent = MD_bilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_long_",disorder, "_balanced_", sex)),
n_comparisons = length(MD_bilateral),
hemisphere_col = "hemi",
structural_subtype = "MD Tracts",
id_col = "f.eid")
MD_unilateral_assoc <- unilateral_structure_assoc(dependent = MD_unilateral,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(MD_unilateral),
structural_subtype = "MD Tracts")
MD_general_assoc <- unilateral_structure_assoc(dependent = MD_general,
independent = disorder,
covariates = brain_structure_covariates_diffusion_no_sex,
dataset = get(paste0("UKB_CP_MDD_imaging_covariates_",disorder, "_balanced_",sex)),
n_comparisons = length(MD_general) -1,
structural_subtype = "MD General Measures")
MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.adjust"] <- MD_general_assoc[MD_general_assoc$brain_phenotype == "MD_global", "p.value"]
## Combine association results
all_assoc <- do.call("rbind", list(subcortical_volume_assoc, cortical_volume_assoc, cortical_area_assoc, cortical_thickness_assoc, cortical_area_general_assoc, cortical_thickness_general_assoc, cortical_volume_general_assoc, FA_bilateral_assoc, FA_general_assoc, FA_unilateral_assoc, MD_bilateral_assoc, MD_general_assoc, MD_unilateral_assoc))
## Add column indicating methylation score p-value threshold
all_assoc$disorder  <- disorder
## append association analysis
if (disorder == "chronic_pain"){
assign(paste0("balanced_all_CP_MDD_structure_assoc_", sex), all_assoc)
}else{
assign(paste0("balanced_all_CP_MDD_structure_assoc_", sex) , rbind(get(paste0("balanced_all_CP_MDD_structure_assoc_", sex)), all_assoc))
}
paste("sex-stratified", disorder, "and brain strucutre association complete")
}
}
## Save output
write.csv(all_CP_MDD_structure_assoc, paste0(work_dir,"output/all_CP_MDD_structure_assoc.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_CP_MDD_structure_assoc_females, paste0(work_dir,"output/all_CP_MDD_structure_assoc_females.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_CP_MDD_structure_assoc_males, paste0(work_dir,"output/all_CP_MDD_structure_assoc_males.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_CP_MDD_structure_assoc_females_site, paste0(work_dir,"output/all_CP_MDD_structure_assoc_females_site.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_comorbidity_structure_assoc, paste0(work_dir,"output/all_comorbidity_structure_assoc.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_comorbidity_structure_assoc_females, paste0(work_dir,"output/all_comorbidity_structure_assoc_females.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_comorbidity_structure_assoc_males, paste0(work_dir,"output/all_comorbidity_structure_assoc_males.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_comorbidity_structure_assoc_females_site, paste0(work_dir,"output/all_comorbidity_structure_assoc_females_site.csv"), quote = FALSE, row.names = FALSE)
write.csv(all_comorbidity_structure_assoc_males_site, paste0(work_dir,"output/all_comorbidity_structure_assoc_males_site.csv"), quote = FALSE, row.names = FALSE)
write.csv(balanced_all_comorbidity_structure_assoc_females, paste0(work_dir,"output/balanced_all_comorbidity_structure_assoc_females.csv"), quote = FALSE, row.names = FALSE)
write.csv(balanced_all_comorbidity_structure_assoc_males, paste0(work_dir,"output/balanced_all_comorbidity_structure_assoc_males.csv"), quote = FALSE, row.names = FALSE)
write.csv(UKB_CP_MDD_demographics, paste0(work_dir,"output/UKB_CP_MDD_demographics.csv"), quote = FALSE, row.names = FALSE)
